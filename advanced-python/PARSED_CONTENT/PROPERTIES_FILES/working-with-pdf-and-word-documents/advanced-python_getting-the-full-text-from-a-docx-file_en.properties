getting-the-full-text-from-a-docx-file_key1=name: getting-the-full-text-from-a-docx-file
getting-the-full-text-from-a-docx-file_key2=Getting the Full Text from a .docx File
getting-the-full-text-from-a-docx-file_key3=If you care only about the text, not the styling information, in the Word document, you can use the getText() function. It accepts a filename of a .docx file and returns a single string value of its text. Open a new file editor window and enter the following code, saving it as readDocx.py:
getting-the-full-text-from-a-docx-file_key4=import docx
getting-the-full-text-from-a-docx-file_key5=def getText(filename):
    doc = docx.Document(filename)
    fullText = []
    for para in doc.paragraphs:
        fullText.append(para.text)
    return '\n'.join(fullText)
The getText() function opens the Word document, loops over all the Paragraph objects in the paragraphs list, and then appends their text to the list in fullText. After the loop, the strings in fullText are joined together with newline characters.
getting-the-full-text-from-a-docx-file_key6=The readDocx.py program can be imported like any other module. Now if you just need the text from a Word document, you can enter the following:
getting-the-full-text-from-a-docx-file_key7=Document Title
A plain paragraph with some bold and some italic
Heading, level 1
Intense quote
first item in unordered list
first item in ordered list
You can also adjust getText() to modify the string before returning it. For example, to indent each paragraph, replace the append() call in readDocx.py with this:
getting-the-full-text-from-a-docx-file_key8=fullText.append(' ' + para.text)
To add a double space in between paragraphs, change the join() call code to this:
getting-the-full-text-from-a-docx-file_key9=return '\n\n'.join(fullText)
As you can see, it takes only a few lines of code to write functions that will read a .docx file and return a string of its content to your liking.
getting-the-full-text-from-a-docx-file_key10=Styling Paragraph and Run Objects
getting-the-full-text-from-a-docx-file_key11=In Word for Windows, you can see the styles by pressing CTRL-ALT-SHIFT-S to display the Styles pane, which looks like Figure 13-5. On OS X, you can view the Styles pane by clicking the View▸Styles menu item.
getting-the-full-text-from-a-docx-file_key12=Figure 13-5. Display the Styles pane by pressing CTRL-ALT-SHIFT-S on Windows.
getting-the-full-text-from-a-docx-file_key13=Word and other word processors use styles to keep the visual presentation of similar types of text consistent and easy to change. For example, perhaps you want to set body paragraphs in 11-point, Times New Roman, left-justified, ragged-right text. You can create a style with these settings and assign it to all body paragraphs. Then, if you later want to change the presentation of all body paragraphs in the document, you can just change the style, and all those paragraphs will be automatically updated.
getting-the-full-text-from-a-docx-file_key14=For Word documents, there are three types of styles: Paragraph styles can be applied to Paragraph objects, character styles can be applied to Run objects, and linked styles can be applied to both kinds of objects. You can give both Paragraph and Run objects styles by setting their style attribute to a string. This string should be the name of a style. If style is set to None, then there will be no style associated with the Paragraph or Run object.
getting-the-full-text-from-a-docx-file_key15=The string values for the default Word styles are as follows:
getting-the-full-text-from-a-docx-file_key16='Normal'               'Heading5'             'ListBullet'                     'ListParagraph'
getting-the-full-text-from-a-docx-file_key17='BodyText'             'Heading6'              'ListBullet2'                    'MacroText'
getting-the-full-text-from-a-docx-file_key18='BodyText2'            'Heading7'               'ListBullet3'                   'NoSpacing'
getting-the-full-text-from-a-docx-file_key19='BodyText3'             'Heading8'               'ListContinue'                 'Quote'
getting-the-full-text-from-a-docx-file_key20='Caption'               'Heading9'               'ListContinue2'                'Subtitle'
getting-the-full-text-from-a-docx-file_key21='Heading1'              'IntenseQuote'            'ListContinue3'                'TOCHeading'
getting-the-full-text-from-a-docx-file_key22='Heading2'               'List'                    'ListNumber'                   'Title'
getting-the-full-text-from-a-docx-file_key23='Heading3'               'List2'                   'ListNumber2'
getting-the-full-text-from-a-docx-file_key24='Heading4'               'List3'                    'ListNumber3'
getting-the-full-text-from-a-docx-file_key25=When setting the style attribute, do not use spaces in the style name. For example, while the style name may be Subtle Emphasis, you should set the style attribute to the string value 'SubtleEmphasis' instead of 'Subtle Emphasis'. Including spaces will cause Word to misread the style name and not apply it.
getting-the-full-text-from-a-docx-file_key26=When using a linked style for a Run object, you will need to add 'Char' to the end of its name. For example, to set the Quote linked style for a Paragraph object, you would use paragraphObj.style = 'Quote', but for a Run object, you would use runObj.style = 'QuoteChar'.
getting-the-full-text-from-a-docx-file_key27=In the current version of Python-Docx (0.7.4), the only styles that can be used are the default Word styles and the styles in the opened .docx. New styles cannot be created—though this may change in future versions of Python-Docx.
